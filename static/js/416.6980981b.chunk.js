"use strict";(self.webpackChunk_kne_components_scroll_loader=self.webpackChunk_kne_components_scroll_loader||[]).push([[35,416],{71830:(e,t,a)=>{a.r(t),a.d(t,{FetchScrollLoader:()=>b,default:()=>C});var r=a(94922),n=a.n(r),l=a(55199),o=a(20046),s=a(98424),c=a(78678),i=a(54159),p=a.n(i),u=a(20274),d=(a(1251),a(16052)),m=a.n(d),g=a(33227),f=a.n(g),h=a(64755),P=a.n(h),S=a(67823),v="_7DqrJ";const y=e=>{let{getScrollerRef:t,loadMore:a,maxFullCount:n}=e;const l=(0,c.A)(a),o=(0,c.A)(t);return(0,r.useEffect)(()=>{let e=n;const t=o(),a=async()=>{t.clientHeight===t.scrollHeight&&e>0&&(await l().then(()=>new Promise(e=>{setTimeout(e,500)})),e--,await a())};a()},[n,l,o]),null},C=(0,u.createWithIntlProvider)("zh-CN",{loadComplete:"\u52a0\u8f7d\u5b8c\u6210"},"scroll-loader")((0,r.forwardRef)((e,t)=>{const{formatMessage:a}=(0,u.useIntl)(),{className:i,noMore:d,onLoader:m,isLoading:g,completeTips:f,maxFullCount:h,children:P}=Object.assign({},{maxFullCount:3,completeTips:a({id:"loadComplete"})},e),S=(0,r.useRef)(),C=(0,c.A)(m),E=(0,r.useRef)(!d&&!g);E.current=!d&&!g,(0,r.useImperativeHandle)(t,()=>S.current,[]);const N=(0,s.dh)(e=>{const t=e.target;E.current&&t.clientHeight+t.scrollTop+20>t.scrollHeight&&C()},100);return n().createElement(o.A,{className:p()("load-container",i),scrollableNodeProps:{ref:S,onScroll:N}},!g&&!d&&n().createElement(y,{maxFullCount:h,getScrollerRef:()=>S.current,loadMore:C}),n().createElement(l.Space,{direction:"vertical"},n().createElement("div",null,P),g&&!d?n().createElement("div",{className:v},n().createElement(l.Spin,{size:"small"})):null,d&&f?n().createElement("div",{className:v},f):null))}));function E(){return E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},E.apply(null,arguments)}const N=["dataFormat","mergeList","api","searchProps","getSearchProps","children","render"],b=(0,r.forwardRef)((e,t)=>{const a=Object.assign({},{api:{loader:()=>({pageData:[],totalCount:0})},mergeList:(e,t)=>Object.assign({},t,{pageData:e.pageData.concat(t.pageData)}),dataFormat:e=>({list:e.pageData,total:e.totalCount}),children:e=>(console.log(e),null),render:e=>{let{fetchApi:t,children:a}=e;return a}},e),{dataFormat:r,mergeList:l,api:o,searchProps:s,getSearchProps:c,children:i,render:p}=a,u=function(e,t){if(null==e)return{};var a={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;a[r]=e[r]}return a}(a,N),d=Object.assign({},{paramsType:"data",current:"currentPage",pageSizeName:"perPage",pageSize:20},e.pagination),g=e=>{if(c&&(0,S.isNotEmpty)(e)){const t=c(e);return(0,S.isNotEmpty)(t)?{[d.paramsType]:t}:{}}return{}};return n().createElement(m(),E({},P()({},o,g(s)),{render:e=>{const t=r(e.data),a=f()(e.requestParams,[d.paramsType,d.current],1),o=f()(e.requestParams,[d.paramsType,d.pageSizeName])||d.pageSize,c=!t.total||a*o>=t.total;return p({fetchApi:e,children:n().createElement(C,E({},u,{isLoading:!e.isComplete,noMore:c,onLoader:async()=>{await e.loadMore(P()({},g(s),{[d.paramsType]:{[d.pageSizeName]:o,[d.current]:a+1}}),l)}}),i({fetchApi:e,list:t.list,data:e.data}))})},ref:t}))})}}]);
//# sourceMappingURL=416.6980981b.chunk.js.map