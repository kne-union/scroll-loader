"use strict";(self.webpackChunk_kne_components_scroll_loader=self.webpackChunk_kne_components_scroll_loader||[]).push([[35,416],{71830:(e,a,t)=>{t.r(a),t.d(a,{FetchScrollLoader:()=>N,default:()=>P});var r=t(94922),n=t.n(r),l=t(55199),o=t(39264),s=t(98424),c=t(78678),i=t(54159),p=t.n(i),u=t(60213),m=(t(1251),t(16052)),d=t.n(m),g=t(33227),f=t.n(g),h=t(64755),S=t.n(h),y=t(67823),C="_7DqrJ";const E=e=>{let{getScrollerRef:a,loadMore:t,maxFullCount:n}=e;const l=(0,c.A)(t),o=(0,c.A)(a);return(0,r.useEffect)((()=>{let e=n;const a=o(),t=async()=>{a.clientHeight===a.scrollHeight&&e>0&&(await l().then((()=>new Promise((e=>{setTimeout(e,500)})))),e--,await t())};t()}),[n,l,o]),null},P=(0,u.Fr)("zh-CN",{loadComplete:"\u52a0\u8f7d\u5b8c\u6210"},"scroll-loader")((0,r.forwardRef)(((e,a)=>{const{formatMessage:t}=(0,u.tz)(),{className:i,noMore:m,onLoader:d,isLoading:g,completeTips:f,maxFullCount:h,children:S}=Object.assign({},{maxFullCount:3,completeTips:t({id:"loadComplete"})},e),y=(0,r.useRef)(),P=(0,c.A)(d),b=(0,r.useRef)(!m&&!g);b.current=!m&&!g,(0,r.useImperativeHandle)(a,(()=>y.current),[]);const v=(0,s.dh)((e=>{const a=e.target;b.current&&a.clientHeight+a.scrollTop+20>a.scrollHeight&&P()}),100);return n().createElement(o.A,{className:p()("load-container",i),scrollableNodeProps:{ref:y,onScroll:v}},!g&&!m&&n().createElement(E,{maxFullCount:h,getScrollerRef:()=>y.current,loadMore:P}),n().createElement(l.Space,{direction:"vertical"},n().createElement("div",null,S),g&&!m?n().createElement("div",{className:C},n().createElement(l.Spin,{size:"small"})):null,m&&f?n().createElement("div",{className:C},f):null))})));function b(){return b=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},b.apply(null,arguments)}const v=["dataFormat","mergeList","api","searchProps","getSearchProps","children","render"],N=(0,r.forwardRef)(((e,a)=>{const t=Object.assign({},{api:{loader:()=>({pageData:[],totalCount:0})},mergeList:(e,a)=>Object.assign({},a,{pageData:e.pageData.concat(a.pageData)}),dataFormat:e=>({list:e.pageData,total:e.totalCount}),children:e=>(console.log(e),null),render:e=>{let{fetchApi:a,children:t}=e;return t}},e),{dataFormat:r,mergeList:l,api:o,searchProps:s,getSearchProps:c,children:i,render:p}=t,u=function(e,a){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==a.indexOf(r))continue;t[r]=e[r]}return t}(t,v),m=Object.assign({},{paramsType:"data",current:"currentPage",pageSizeName:"perPage",pageSize:20},e.pagination),g=e=>{if(c&&(0,y.isNotEmpty)(e)){const a=c(e);return(0,y.isNotEmpty)(a)?{[m.paramsType]:a}:{}}return{}};return n().createElement(d(),b({},Object.assign({},o,g(s)),{render:e=>{const a=r(e.data),t=f()(e.requestParams,[m.paramsType,m.current],1),o=f()(e.requestParams,[m.paramsType,m.pageSizeName])||m.pageSize,c=!a.total||t*o>=a.total;return p({fetchApi:e,children:n().createElement(P,b({},u,{isLoading:!e.isComplete,noMore:c,onLoader:async()=>{await e.loadMore(S()({},g(s),{[m.paramsType]:{[m.pageSizeName]:o,[m.current]:t+1}}),l)}}),i({fetchApi:e,list:a.list,data:e.data}))})},ref:a}))}))}}]);
//# sourceMappingURL=416.26e8fcb9.chunk.js.map